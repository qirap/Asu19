@model IEnumerable<Asu19.Areas.Account.Models.UserCarInfo>
@{
    ViewData["Title"] = "Personal Page";
}

@*<div class="text-center">
    <h1>Здравствуйте, @User.Claims.ElementAt(1).Value</h1>
    <h2>Список ваших авто</h2>
    <ul class="list-group">
        @foreach (var item in Model)
        {
            <li id="@($"{item.Brand}_{item.Model}")" class="list-group-item w-25">@item.Brand @item.Model<button onclick="remove('@item.Brand', '@item.Model')" type="button" class="btn btn-danger">Delete</button></li>
        }
        <li class="list-group-item active" aria-current="true"><a href="/addcar">Добавить авто</a></li>
    </ul>
    <br />
    <h2>Список ваших заявок</h2>
    <ul class="list-group">
        @foreach (var item in ViewBag.Requests)
        {
            <li class="list-group-item w-25">@item.Status @item.StartTime</li>
        }
        @if(Model.FirstOrDefault() != null)
        {
            <li class="list-group-item active" aria-current="true"><a href="/addrequest">Создать заявку</a></li>
        }
        else
        {
            <li class="list-group-item alert-danger" aria-current="true">У вас нет авто</li>
        }
    </ul>
</div>*@

<div class="container text-center mt-5">
    <div class="row">
        <div class="col">
            <div class="card bg-dark text-white" style="border-radius: 1rem;">
                <div class="card-body p-5">
                    <div class="mb-md-5 mt-md-4 pb-5">
                        <h2 class="fw-bold mb-2 text-uppercase">Ваши авто</h2>
                        <ul class="list-group">
                            @foreach (var item in Model)
                            {
                                <li id="@($"{item.Brand}_{item.Model}")" class="list-group-item w-100">@item.Brand @item.Model<button onclick="remove('@item.Brand', '@item.Model')" type="button" class="btn btn-danger justify-content-end">Delete</button></li>
                            }
                        </ul>
                        <a class="btn gradient-custom mt-3 btn-lg" href="/addcar" role="button">Добавить авто</a>
                    </div>
                </div>
            </div>
        </div>
        <div class="col">
            <div class="card bg-dark text-white" style="border-radius: 1rem;">
                <div class="card-body p-5 text-center">
                    <div class="mb-md-5 mt-md-4 pb-5">
                        <h2 class="fw-bold mb-2 text-uppercase">Ваши заявки</h2>

                        <form method="post" action="/addrequest">
                            <select name="car" class="form-select" aria-label="Default select example">
                                @foreach (var item in Model)
                                {
                                    <option value="@($"{item.Brand}_{item.Model}")">@item.Brand @item.Model</option>
                                }
                            </select>

                            <ul class="list-group mt-3">
                                @foreach (var item in ViewBag.Requests)
                                {
                                    <li class="list-group-item">@item.Status @item.StartTime</li>
                                }
                            </ul>

                            @if (Model.FirstOrDefault() != null)
                            {
                                <a class="btn gradient-custom mt-3 btn-lg" href="/addrequest" role="button">Создать заявку</a>
                            }
                            else
                            {
                                <a class="btn gradient-custom mt-3 btn-lg" href="/addcar" role="button">Добавить авто</a>
                            }
                            
                        </form>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>


        <script>
            async function remove(brand, model) {
                const response = await fetch("/delcar", {
                    method: "POST",
                    headers: { "Accept": "application/json", "Content-Type": "application/json" },
                    body: JSON.stringify({
                        Brand: brand,
                        Model: model
                    })
                });
                if (response.ok)
                    document.getElementById(brand + "_" + model).style.display = "none";
            }
        </script>
